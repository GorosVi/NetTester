Модуль определения задержки пакетов в ЛВС
=========================================

Задачей модуля является измерение задержки, возникающей при передаче пакета в локальной вычислительной сети от источника до целевого устройства и возврате его обратно на устройство-источник.

Модуль можно настроить на желаемую интенсивность отправки пакетов, в пределах от 0 до полной загрузки интерфейса к ЛВС.

Полученные значения задержки выдаются в виде результата для каждого обработанного пакета.

Передаваемые в сеть данные
--------------------------

Модуль работает с протоколом IP, позволяя пользователю задавать адрес получателя, количество отправляемых пакетов, размер пакета (в битах) и заголовок протокола вышележащего уровня (в данной версии - UDP). Заполнение поля данных генерируется модулем при отправке пакета, и содержит информацию, необходимую для вычисления времени пакета в пути.

Интенсивность генерируемого трафика задаётся с помощью задержки между отправляемыми в сеть пакетами. Единица измерения задержки должна быть определена в дальнейшем.

Параметры модуля и буфер заголовка пакета доступны для пользовательского ПО в заданной области оперативной памяти.



Принимаемые из сети данные
--------------------------

Модуль прослушивает поступающий на вход трафик и отбирает для обработки IP-пакеты, отправленные устройству.

Для принятых тестовых пакетов вычисляется разница между временем отправки и текущим, и сбрасывается на хост. На хост также можно отправлять номер принятого пакета - позволит увидеть потерянные при передаче пакеты (но можно и просто считать принятые \ отправленные пакеты).

Фрагментация пакетов при приёме (пока) считается недопустимой и приведёт к его потере.


Алгоритм работы
---------------
Модуль содержит счётчик, на основе которого производится измерение временных интервалов.

Пользовательское ПО задаёт параметры модуля (адрес приёмника, количество и параметры пакетов). После задания корректных значений пользовательское ПО активирует флаг запуска (роль флага можно передать на счётчик отправляемых пакетов, записывая его последним)

Запущенный модуль собирает пакет из заголовка IP, пользовательского заголовка протокола верхнего уровня и данных, начало которых содержит время отправки пакета, а остаток до окончания пакета заполняется нулями.

Пакеты отправляются через равные промежутки времени, поэтому можно следить за последовательностью возврата и временем в пути, зная лишь время его отправки.

Параллельно модуль работает на приём возвращённых пакетов. Из потока выбираются IP-пакеты с адресом модуля-приёмника и проводится вычисление времени в пути. Затем результат вычисления передаётся управляющему ПО.

После завершения работы по отправке пакетов модуль поднимает флаг готовности, но при этом продолжает принимать отправленные ранее пакеты. Для остановки приёма пользовательское ПО выставляет флаг остановки.